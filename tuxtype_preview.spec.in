## tuxtype_preview.spec.in - process with configure to substitute in PACKAGE
## VERSION strings
#
#
# spec file for package tuxtype_preview
#
# This specfile version produces rpm packages with "tuxtype_preview"
# in the name, rather than "tuxtype". The tuxtype program is installed
# identically with either specfile.  This flavor is intended for pre-release
# builds.
#
# This file and all modifications and additions to the pristine
# package are under the same license as the package itself.
#

# norootforbuild

Name:           @PACKAGE@_preview
Obsoletes: 	tuxtype <= @VERSION@
Provides:  	tuxtype = @VERSION@
Summary:        Typing tutor for children
Url:            http://alioth.debian.org/projects/tux4kids/
%define         realname @PACKAGE@
%define         progname tuxtype
License:        GNU General Public License (GPL) v2, Open Font License v1.1, free (BSD-like) license
Group:          Amusements/Games/Action/Other
Version:        @VERSION@
Release:        1
Vendor:         openSUSE-Education
Source:         %realname-%version.tar.bz2

BuildRequires:  SDL_image-devel >= 1.2.2  
#BuildRequires:  SDL_ttf-devel > 2.0.8  
BuildRequires:  SDL-devel  
BuildRequires:  SDL_mixer-devel  
BuildRequires:  SDL_Pango-devel 
BuildRequires:  ImageMagick

%if 0%{?suse_version}  
BuildRequires:  update-desktop-files  
BuildRequires:  fdupes  
%endif  

%if 0%{?fedora_version}  
BuildRequires:  desktop-file-utils  
%endif  

%if 0%{?mandriva_version}  
BuildRequires:  desktop-file-utils  
Requires(post): desktop-file-utils  
Requires(postun): desktop-file-utils  
%endif
%if 0%{?mandriva_version} >= 2009
BuildRequires: pulseaudio-esound-compat
%endif  

BuildRoot:      %{_tmppath}/%{progname}-%{version}-build


%description
Tux Typing is an educational typing tutor game starring Tux, the Linux
penguin.

In "Fish Cascade" you control Tux as he searches for fish to eat. Fish fall
from the top of the screen. These fish have letters on them.  Unforunately
for Tux, eating a fish with a letter on it will cause his stomach to
become ill, so it is up to you to help Tux eat fish!  By typing the
letters, it will cause them to disappear so tux can chow down on the
fish.

In "Comet Zap" you control Tux as he defends the cities from comets.  To
protect a city from a comet, type the letter on the comet and it will
cause Tux to destroy it with a laser! (In case you wondered, Comet Zap
is an adaptation of the *great* math drill game, "Tux, of Math Command").

"Phrase Typing" offers practice typing phrases and sentences, with on-
screen display of accuracy and typing speed.

"Lessons" is an additional typing activity that we have not yet
completed. You will find other menu entries for planned features
that still need to be implemented.

Authors:
--------
    Current maintainer and programming lead:
    David Bruce <davidstuartbruce@gmail.com>

    Jesse Andrews <jdandr2@uky.edu>
    Calvin Arndt <calarndt@tux4kids.org>
    Sam Hart <hart@geekcomix.com>  --- Sam started it all with TuxType 1!!!
    Jacob Greig <bombastic@firstlinux.net>
    Sreyas Kurumanghat <k.sreyas@gmail.com>
    Sreerenj Balachandran <bsreerenj@gmail.com>
    Vimal Ravi <vimal_ravi@rediff.com>
    Prince K. Antony <prince.kantony@gmail.com>
    Mobin Mohan <mobinmohan@gmail.com>


%prep
%setup -q -n %realname-%version

%build
%configure --docdir="%{_defaultdocdir}/%{progname}" --disable-rpath
make %{?jobs:-j %jobs}


%install
%if 0%{?suse_version} < 1030
for i in $(find . -progname Makefile ); do
    sed -i "s#MKDIR_P#mkdir_p#g" $i
done
%endif

make DESTDIR=%{buildroot} install
# remove unneeded data
rm -rf %buildroot/usr/doc/tuxtype
rm -rf %buildroot%_datadir/tuxtype/{autorun.inf,OFL.txt}

# install desktop file and icon
mkdir -p %buildroot%_datadir/pixmaps
convert -scale 48x48 tuxtype.ico %buildroot%_datadir/pixmaps/%progname.png
rm -rf %buildroot%_datadir/tuxtype/*.ico

%if 0%{?suse_version}
#install -Dm644 %{SOURCE1} %buildroot%_datadir/applications/%progname.desktop
%suse_update_desktop_file -i %progname Game KidsGame
# save some discspace using symlinks
%fdupes -s %buildroot
%endif

%if 0%{?fedora_version}
# install desktop file
desktop-file-install --vendor="%{vendor}" \
  --dir=%buildroot/%_datadir/applications \
  tuxtype.desktop
%endif

%if 0%{?mandriva_version}
#desktop-file-install --vendor="%{vendor}" \
#  --dir=%buildroot/%_datadir/applications \
install -Dm644  tuxtype.desktop %buildroot/%_datadir/applications/%progname.desktop
%endif

# grmbl....
#if [ ! -d %buildroot%{_datadir}/fonts/truetype ]; then
#	mkdir -p %buildroot%{_datadir}/fonts/truetype
#	ln -s %{_datadir}/tuxtype/fonts %buildroot%{_datadir}/fonts/truetype/ttf-sil-andika
#fi

%find_lang %progname

%if 0%{?mandriva_version}
%post
%{update_menus}

%postun
%{clean_menus}
%endif

%clean
rm -rf %buildroot

%files -f %progname.lang
%defattr(-,root,root)
#%doc README AUTHORS COPYING ChangeLog TODO 
%dir %_docdir/%{progname}
%doc %_docdir/%{progname}/*
%doc data/sounds/README_SOUNDS.TXT
%doc data/images/README_IMAGES.TXT

#%if 0%{?fedora_version}
#%dir %_docdir/%{progname}
#%doc %_docdir/%{progname}/*
#%endif

%{_bindir}/tuxtype
%dir %_datadir/tuxtype
#%dir %_datadir/tuxtype/fonts
#%dir %{_datadir}/fonts/truetype
#%dir %{_datadir}/fonts/truetype/ttf-sil-andika
%_datadir/tuxtype/*
%_datadir/applications/*%progname.desktop
%_datadir/pixmaps/%progname.png


%changelog 
